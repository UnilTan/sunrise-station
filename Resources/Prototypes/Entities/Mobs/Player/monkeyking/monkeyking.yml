# Monkey King Entity Prototypes

- type: entity
  parent: [ SimpleMobBase, FlyingMobBase, MobCombat ]
  id: BaseMobMonkeyKing
  suffix: ""
  name: monkey king
  description: A mighty gorilla king risen from redspace, leader of the monkey uprising.
  abstract: true
  components:
  - type: Bloodstream
    bloodMaxVolume: 650
  - type: GhostRole
    allowMovement: true
    allowSpeech: true
    makeSentient: true
    name: ghost-role-information-monkey-king-name
    description: ghost-role-information-monkey-king-description
    rules: ghost-role-information-monkey-king-rules
    mindRoles:
    - MindRoleGhostRoleTeamAntagonist
    raffle:
      settings: default
  - type: GhostTakeoverAvailable
  - type: HTN
    rootTask:
      task: XenoCompound
    blackboard:
      NavInteract: !type:Bool
        true
      NavPry: !type:Bool
        true
      NavSmash: !type:Bool
        true
  - type: NpcFactionMember
    factions:
    - MonkeyKing
  - type: Speech
    speechVerb: LargeMob
  - type: CombatMode
  - type: MobMover
  - type: InputMover
  - type: MovementSpeedModifier
    baseWalkSpeed: 3
    baseSprintSpeed: 5
    baseWeightlessModifier: 1.5
  - type: Sprite
    sprite: Mobs/Animals/gorilla.rsi
    noRot: true
    layers:
    - map: [ "enum.DamageStateVisualLayers.Base" ]
      state: crawling
  - type: Appearance
  - type: DamageStateVisuals
    states:
      Alive:
        Base: crawling
      Critical:
        Base: dead
      Dead:
        Base: dead
  - type: Physics
    bodyType: KinematicController
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeCircle
          radius: 0.48
        density: 200
        mask:
        - FlyingMobMask
        layer:
        - FlyingMobLayer
  - type: MobState
  - type: MobStateActions
    actions:
      Critical:
      - ActionCritSuccumb
      - ActionCritLastWords
  - type: MobThresholds
    thresholds:
      0: Alive
      450: Critical
      500: Dead
  - type: SlowOnDamage
    speedModifierThresholds:
      250: 0.7
      400: 0.5
  # High physical damage resistance as specified
  - type: Damageable
    damageContainer: Biological
    damageModifierSet: MonkeyKing
  - type: StatusEffects
    allowed:
    - Electrocution
    - TemporaryBlindness
    - Pacified
    - RadiationProtection
    - Adrenaline
  - type: Temperature
    heatDamageThreshold: 400
  - type: Metabolizer
    solutionOnBody: false
    updateInterval: 0.25
    metabolizerTypes: [ MonkeyKing ]
    groups:
    - id: Medicine
    - id: Poison
  - type: Butcherable
    spawned:
    - id: FoodMeat
      amount: 4
  - type: InteractionPopup
    successChance: 0.15
    interactSuccessString: petting-success-monkey-king
    interactFailureString: petting-failure-monkey-king
    interactFailureSound:
      path: /Audio/Animals/monkey_scream.ogg
    soundPerceivedByOthers: false
  - type: MeleeWeapon
    altDisarm: false
    soundHit:
      collection: Punch
    damage:
      types:
        Blunt: 20
  - type: Tag
    tags:
    - CannotSuicide
    - DoorBumpOpener
    - StunImmune
  - type: Puller
    needsHands: false
  - type: RandomMetadata
    nameSegments:
    - NamesFirst
    nameFormat: "{0} the Monkey King"
  - type: Prying
    pryPowered: true
    force: true
    speedModifier: 2.5
    useSound:
      path: /Audio/Items/crowbar.ogg

- type: entity
  parent: BaseMobMonkeyKing
  id: MobMonkeyKing
  components:
  - type: GhostPanelAntagonistMarker
    name: ghost-panel-antagonist-monkey-king-name
    description: ghost-panel-antagonist-monkey-king-description
    priority: 55
  - type: MonkeyKing
  - type: GhostRole
    mindRoles:
    - MindRoleMonkeyKing
  - type: GuideHelp
    guides:
    - MinorAntagonists

# Armed monkey summoned by the king
- type: entity
  parent: [ SimpleMobBase, MobCombat ]
  id: MobMonkeyArmed
  name: armed monkey
  description: An intelligent monkey armed and ready for battle.
  components:
  - type: Sprite
    drawdepth: Mobs
    layers:
    - map: ["enum.DamageStateVisualLayers.Base"]
      state: monkey
      sprite: Mobs/Animals/monkey.rsi
  - type: Physics
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeCircle
          radius: 0.35
        density: 50
        mask:
        - MobMask
        layer:
        - MobLayer
  - type: MobState
  - type: MobThresholds
    thresholds:
      0: Alive
      50: Critical
      80: Dead
  - type: Butcherable
    spawned:
    - id: FoodMeat
      amount: 1
  - type: MeleeWeapon
    soundHit:
      collection: Punch
    damage:
      types:
        Blunt: 8
  - type: NpcFactionMember
    factions:
    - MonkeyKing
  - type: HTN
    rootTask:
      task: SimpleHostileCompound
  - type: GhostRole
    allowMovement: true
    allowSpeech: true
    makeSentient: true
    name: ghost-role-information-armed-monkey-name
    description: ghost-role-information-armed-monkey-description
    rules: ghost-role-information-armed-monkey-rules
    mindRoles:
    - MindRoleGhostRoleTeamAntagonist
    raffle:
      settings: short
  - type: GhostTakeoverAvailable
  - type: Speech
    speechVerb: SmallMob
    speechSounds: Squeak
  - type: RandomMetadata
    nameSegments:
    - NamesFirst
    nameFormat: "{0} the Armed Monkey"
  - type: HandsShort # Monkeys have only one hand as specified
  - type: Inventory
    speciesId: monkey
    templateId: monkey
  # Random weapon will be added via loadout system